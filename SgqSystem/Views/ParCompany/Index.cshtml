@using SgqSystem.Helpers

@{

    ViewBag.Title = @Resources.Resource.company_register;

    var urlCompany = Url.Action("AddUpdateParCompany", "api/Company"); //URL relativa
    var urlStructure = Url.Action("AddUpdateParStructure", "api/Company"); //URL relativa
    var urlStructureGroup = Url.Action("AddUpdateParStructureGroup", "api/Company"); //URL relativa
    var urlHome = Url.Action("Index", "Home");

}

<div class="page-content-wrapper">
    <!-- BEGIN CONTENT BODY -->
    <div class="page-content" style="min-height: 650px;">
        <!-- BEGIN PAGE HEADER-->
        <!-- BEGIN PAGE TITLE-->
        <h1 class="page-title">
            @Resources.Resource.company_register
            <small>@Resources.Resource.register_company_and_its_structure</small>
        </h1>
        <!-- END PAGE TITLE-->
        <!-- BEGIN PAGE BAR -->
        <div class="page-bar">
            <ul class="page-breadcrumb">
                <li>
                    <a href="@urlHome">Home</a>
                    <i class="fa fa-angle-right"></i>
                </li>
                <li>
                    <span> @Resources.Resource.company_register </span>
                </li>
            </ul>
            <div class="page-toolbar">
                <!--<div id="dashboard-report-range" class="pull-right tooltips btn btn-fit-height green" data-placement="top" data-original-title="Change dashboard date range">-->
                <div id="dashboard-report-range" class="pull-right tooltips btn btn-fit-height green">
                    <i class="fa fa-calendar"></i>&nbsp;
                    <span class="thin uppercase" id="currentDate"></span>&nbsp;
                </div>
            </div>
        </div>
        <!-- END PAGE BAR -->
        <!-- END PAGE HEADER-->
        <div class="row">
            <div class="col-xs-12">
                <div class="portlet light bordered">
                    <div class="portlet-title tabbable-line">
                        <div class="caption">
                            <i class="icon-share font-dark"></i>
                            <span class="caption-subject font-dark bold uppercase">@Resources.Resource.company_register</span>
                        </div>
                    </div>
                    <div class="portlet-body">
                        <div class="tab-content">
                            <div class="tab-pane active" id="setup_tab">

                                <div class="panel-group accordion" id="company_accordion">
                                    <div class="panel panel-default">
                                        <div class="panel-heading">
                                            <div class="row panel-title">
                                                <div class="col-xs-12">
                                                    <h4 class="panel-title">
                                                        <a class="accordion-toggle collapsed" data-toggle="collapse" data-parent="#company_accordion" href="#company_collapse" aria-expanded="false" id="level2Title"> @Resources.Resource.company </a>
                                                    </h4>
                                                </div>
                                            </div>
                                        </div>
                                        <div id="company_collapse" class="panel-collapse collapse" aria-expanded="false" style="height: 0px;">
                                            <div class="panel-body">
                                                <div id="ParLevel2">
                                                    @Html.Partial("~/Views/ParCompany/ParCompany.cshtml")
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="panel-group accordion" id="structure_accordion">
                                    <div class="panel panel-default">
                                        <div class="panel-heading">
                                            <div class="row panel-title">
                                                <div class="col-xs-12">
                                                    <h4 class="panel-title">
                                                        <a class="accordion-toggle collapsed" data-toggle="collapse" data-parent="#structure_accordion" href="#structure_collapse" aria-expanded="false" id="level2Title"> @Resources.Resource.company_structure </a>
                                                    </h4>
                                                </div>
                                            </div>
                                        </div>
                                        <div id="structure_collapse" class="panel-collapse collapse" aria-expanded="false" style="height: 0px;">
                                            <div class="panel-body">
                                                <div id="ParLevel2">
                                                    @Html.Partial("~/Views/ParCompany/ParStructure.cshtml")
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="panel-group accordion" id="structure_group_accordion">
                                    <div class="panel panel-default">
                                        <div class="panel-heading">
                                            <div class="row panel-title">
                                                <div class="col-xs-12">
                                                    <h4 class="panel-title">
                                                        <a class="accordion-toggle collapsed" data-toggle="collapse" data-parent="#structure_group_accordion" href="#structure_group_collapse" aria-expanded="false" id="level2Title"> @Resources.Resource.structure_group </a>
                                                    </h4>
                                                </div>
                                            </div>
                                        </div>
                                        <div id="structure_group_collapse" class="panel-collapse collapse" aria-expanded="false" style="height: 0px;">
                                            <div class="panel-body">
                                                <div id="ParLevel2">
                                                    @Html.Partial("~/Views/ParCompany/ParStructureGroup.cshtml")
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                            </div>

                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- END CONTENT BODY -->
</div>

<script>

    $.fn.serializeObject = function () {
        var o = {};
        var a = this.serializeArray();
        $.each(a, function () {
            if (o[this.name] !== undefined) {
                if (!o[this.name].push) {
                    o[this.name] = [o[this.name]];
                }
                o[this.name].push(this.value || '');
            } else {
                o[this.name] = this.value || '';
            }
        });
        return o;
    };

    var urlCompany = '@Html.Raw(@urlCompany)';
    var urlStructure = '@Html.Raw(@urlStructure)';
    var urlStructureGroup = '@Html.Raw(@urlStructureGroup)';

    $(".sidebar-toggler").removeClass("hide");
    $(".page-sidebar-wrapper").removeClass("hide");

    navbarSelect("navbar2");

    var monthNames = [
        '@Resources.Resource.january',
        '@Resources.Resource.february',
        '@Resources.Resource.march',
        '@Resources.Resource.april',
        '@Resources.Resource.may',
        '@Resources.Resource.june',
        '@Resources.Resource.july',
        '@Resources.Resource.august',
        '@Resources.Resource.september',
        '@Resources.Resource.october',
        '@Resources.Resource.november',
        '@Resources.Resource.december'];

    function twoDigits(str) {
        str = ("000" + str).slice(-2);
        return str;
    }

    function watcher() {

        var date = new Date();
        var day = date.getDate();
        var monthIndex = date.getMonth();
        var year = date.getFullYear();
        var hour = date.getHours();
        var minute = date.getMinutes();
        var second = date.getSeconds();

        $("#currentDate").text(twoDigits(day) + ' @Resources.Resource.of ' + monthNames[monthIndex] + ' @Resources.Resource.of ' + year + ' ' + twoDigits(hour) + ':' + twoDigits(minute) + ':' + twoDigits(second));

        setTimeout(watcher, 1000);
    }

    watcher();



    var urlCompany = '@Html.Raw(@urlCompany)';

    var indexCompany = {
        enviarDadosParaApi: function (e) {
            var dados = $($('form')[0]).serializeObject();
            $.post(urlCompany, dados, function (objetoReturn, statusmessage, respostaCompleta) {
                console.log(objetoReturn);
                console.log(statusmessage);
                console.log(respostaCompleta);
            }).fail(function (e, h, x) {
                console.log(e);
            });;
        }
    }

    var indexStructure = {
        enviarDadosParaApi: function (e) {
            var dados = $($('form')[1]).serializeObject();
            $.post(urlStructure, dados, function (objetoReturn, statusmessage, respostaCompleta) {
                console.log(objetoReturn);
                console.log(statusmessage);
                console.log(respostaCompleta);
            }).fail(function (e, h, x) {
                console.log(e);
            });;
        }
    }

    var indexStructureGroup = {
        enviarDadosParaApi: function (e) {
            var dados = $($('form')[2]).serializeObject();
            $.post(urlStructureGroup, dados, function (objetoReturn, statusmessage, respostaCompleta) {
                console.log(objetoReturn);
                console.log(statusmessage);
                console.log(respostaCompleta);
            }).fail(function (e, h, x) {
                console.log(e);
            });;
        }
    }
</script>
