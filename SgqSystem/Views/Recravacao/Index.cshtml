
@{
    ViewBag.Title = "Index";
    var urlHome = Url.Action("Index", "Home");
}

<div ng-controller="reencravationCtrl" class="page-content" style="min-height: 600px;">
    <br />
    <h1 class="page-title">
        Recavação
        <small>Cadastrar</small>
    </h1>
    <!-- END PAGE TITLE-->
    <!-- BEGIN PAGE BAR -->
    <div class="page-bar">
        <ul class="page-breadcrumb">
            <li>
                <a href="@urlHome">Home</a>
                <i class="fa fa-angle-right"></i>
            </li>
            <li>
                <span> Recavação </span>
            </li>
        </ul>
        <div class="page-toolbar">

        </div>
    </div>

    <div>

        Cadastro de Linhas de Recravação

        <div class="form-group">
            <label>Nome da Linha</label>
            <input ng-model="line.Name" type="text" class="form-control" placeholder="Nome da Linha" />
        </div>
        <div class="form-group">
            <label>Empresa</label>
            <input ng-model="line.ParCompany_Id" type="text" class="form-control" placeholder="Nome da Linha" />
        </div>
        <div class="form-group">
            <label>Quantidade de Cabeçotes</label>
            <input ng-model="line.NumberOfHeads" type="number" class="form-control" placeholder="Nome da Linha" />
        </div>
        <div class="form-group">
            <label>Tipo de Lata</label>
            <input ng-model="line.ParRecravacao_TipoLata_Id" type="text" class="form-control" placeholder="Nome da Linha" />
            <button type="button" class="btn btn-danger btn-sm" ng-click="newLata = !newLata">
                <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
            </button>
        </div>

        {{line}}
    </div>

    <div ng-show="newLata">

        Cadastro de Tipos de Lata

        <div class="form-group">
            <label>Nome</label>
            <input ng-model="lata.Name" type="text" class="form-control" placeholder="Nome da Linha" />
        </div>
        <div class="form-group">
            <label>Descrição</label>
            <input ng-model="lata.Description" type="text" class="form-control" placeholder="Nome da Linha" />
        </div>
        <div class="form-group">
            <label>Quantidade de Cabeçotes</label>
            <input ng-model="lata.NumberOfPoints" type="number" class="form-control" placeholder="Nome da Linha" />
        </div>

        {{lata}}

    </div>

</div>

<script src="~/Scripts/toastr.min.js"></script>

<script>
    (function () {
        //'use strict';

        /*
        START ANGULAR MODULE
        */
        app.controller('reencravationCtrl', ['$scope', '$http',
            function ($scope, $http) {
                let vm = $scope
                vm.newLata = false
                vm.line = {
                    Name: '',
                    ParCompany_Id: null,
                    NumberOfHeads: 0,
                    ParRecravacao_TipoLata_Id: 0
                }
                vm.lata = {
                    Name: '',
                    Description: '',
                    NumberOfPoints: 0,
                }
                vm.companyes = [
                    { Id: 14, Name: 'Barra do Garças' }
                    , { Id: 15, Name: 'Cachoeira Alta' }
                    , { Id: 16, Name: 'Cassilândia' }
                    , { Id: 17, Name: 'Colider' }
                    , { Id: 18, Name: 'Confresa' }
                ]
                vm.latas = []

                vm.saveLataUrl = ''
                vm.saveLata = function () {
                    $http({ method: 'POST', url: vm.saveLataUrl, data: vm.lata })
                        .then(function (r) {
                            if (r.data.errors) {
                                r.data.errors.forEach(function (o) {
                                    toastr.error(o)
                                })
                            } else {
                                toastr.success(r.data.resposta)
                            }
                        });
                }

            }])
    })();
</script>