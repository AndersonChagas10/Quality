
Insert into MigrationHistory (Name, AddDate) VALUES ('SGQ_1.0.8CreateTabelaMotivoseSchedule',GetDate());

GO

IF NOT EXISTS (SELECT * FROM sysobjects WHERE name='MotivoAtraso' AND xtype='U')
Create Table MotivoAtraso (   
	Id int not null identity PRIMARY KEY,
	Motivo varchar(250) not null,
	AddDate datetime not null,
	AlterDate datetime,
	IsActive bit not null default 1
)

GO

IF NOT EXISTS (SELECT * FROM sysobjects WHERE name='ParEvaluationSchedule' AND xtype='U')
Create Table ParEvaluationSchedule (
		Id int not null identity PRIMARY KEY,
		ParEvaluation_Id int not null FOREIGN KEY REFERENCES ParEvaluation(Id),
        Av int not null,
        Inicio  int not null,
        Fim  int not null,
        Shift_Id  int null,
		AddDate datetime not null,
		AlterDate datetime,
		IsActive bit not null default 1
)

GO
 
 IF NOT EXISTS (SELECT * FROM sysobjects WHERE name='CollectionLevel2XMotivoAtraso' AND xtype='U')
 create table CollectionLevel2XMotivoAtraso (
	Id int primary key identity not null,
	AddDate datetime not null,
	AlterDate datetime,
	CollectionLevel2_Id int foreign key references CollectionLevel2(Id),
	MotivoAtraso_Id int not null foreign key references MotivoAtraso(Id)
)

GO



Insert into MigrationHistory (Name, AddDate) VALUES ('SGQ_1.0.8',GetDate())

GO

IF NOT EXISTS (SELECT * FROM sysobjects WHERE name='ParInputTypeValues' AND xtype='U')
create table ParInputTypeValues(
	Id int not null identity primary key,
	Intervalo int NOT NULL,
	Valor int NOT NULL,
	Cor varchar(7) NOT NULL,
	AddDate datetime not null,
	AlterDate datetime null,
	IsActive bit not null default 1,
	ParLevel3Value_Id int not null FOREIGN key REFERENCES ParLevel3Value(Id),
)

GO

IF NOT EXISTS (SELECT * FROM sysobjects WHERE name='DicionarioEstatico' AND xtype='U')
create table DicionarioEstatico(
    Id int primary key identity not null,
    [Key] varchar(255) unique not null,
    ControllerName varchar(155),
    Value varchar(255) not null,
    Descricao varchar(255)
)

GO

IF NOT EXISTS (SELECT * FROM ParFrequency WHERE Name = 'Diario com Intervalo')
	begin
		insert into ParFrequency(Name,[Description],AddDate, AlterDate, IsActive) 
		values('Diario com Intervalo','Diario com Intervalo',GETDATE(),NULL,1)
	end

GO
IF COL_LENGTH('PARLEVEL1XMODULE','ParCluster_Id') IS NULL
    BEGIN
	
		ALTER TABLE VolumeCepDesossa
			add Agendamento VARCHAR(255) NULL;

		ALTER TABLE ParEvaluationSchedule
			ALTER COLUMN Inicio VARCHAR(5) NOT NULL;

		ALTER TABLE ParEvaluationSchedule
			ALTER COLUMN Fim VARCHAR(5) NOT NULL;

		ALTER TABLE ParEvaluationSchedule
			add Intervalo VARCHAR(5) NULL;
    END

GO